<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Stan Routines For Univariate And Multivariate Time Series • atsar</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="bootstrap-toc.css">
<script src="bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="pkgdown.css" rel="stylesheet">
<script src="pkgdown.js"></script><link href="extra.css" rel="stylesheet">
<meta property="og:title" content="Stan Routines For Univariate And Multivariate Time Series">
<meta property="og:description" content="Bundles univariate and multivariate STAN scripts for FISH 507 class.">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-home">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="index.html">atsar</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.6</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="articles/dlm.html">Dynamic linear models in package atsar</a>
    </li>
    <li>
      <a href="articles/fit_stan.html">Fitting time series models in package atsar</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/nwfsc-timeseries/atsar/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="contents col-md-9">


<style>
.nav{
    border:1px solid #ccc;
    border-width:1px 0;
    list-style:none;
    margin:0;
    padding:0;
    text-align:center;
}
.nav li{
    display:inline-block;
}
.nav a{
    display:inline-block;
    padding:5px;
}
</style>
<ul class="nav">
<li>
<p><a href="#install">Install</a></p>
</li>
<li>
<p><a href="#documentation">Documentation</a></p>
</li>
<li>
<p><a href="#example">Example</a></p>
</li>
<li>
<p><a href="#citation">Citation</a></p>
</li>
<li>
<p><a href="#license">License</a></p>
</li>
<li>
<p><a href="https://github.com/nwfsc-timeseries/atsar">GitHub</a></p>
</li>
</ul>
<p>The atsar R package implements Bayesian time series models using Stan, primarily for illustrative purposes and teaching (University of Washington’s Fish 507, Winter quarters). The Stan webpage, and appropriate citation guidelines are <a href="http://mc-stan.org/">here</a>.</p>
<div id="install" class="section level3">
<h3 class="hasAnchor">
<a href="#install" class="anchor"></a>INSTALL</h3>
<p>You can install the development version of the package with:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># install.packages("devtools")</span>
<span class="fu">devtools</span><span class="fu">::</span><span class="fu"><a href="https://devtools.r-lib.org//reference/remote-reexports.html">install_github</a></span><span class="op">(</span><span class="st">"nwfsc-timeseries/atsar"</span><span class="op">)</span></code></pre></div>
</div>
<div id="example" class="section level3">
<h3 class="hasAnchor">
<a href="#example" class="anchor"></a>EXAMPLE</h3>
<p>Simulate data:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://mc-stan.org/rstan">rstan</a></span><span class="op">)</span>
<span class="co">#&gt; Loading required package: StanHeaders</span>
<span class="co">#&gt; Loading required package: ggplot2</span>
<span class="co">#&gt; rstan (Version 2.21.2, GitRev: 2e1f913d3ca3)</span>
<span class="co">#&gt; For execution on a local, multicore CPU with excess RAM we recommend calling</span>
<span class="co">#&gt; options(mc.cores = parallel::detectCores()).</span>
<span class="co">#&gt; To avoid recompilation of unchanged Stan programs, we recommend calling</span>
<span class="co">#&gt; rstan_options(auto_write = TRUE)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/nwfsc-timeseries/atsar">atsar</a></span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span>
<span class="va">s</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cumsum.html">cumsum</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">50</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">s</span><span class="op">)</span></code></pre></div>
<p><img src="README-figs/plot-1.png"><!-- --></p>
<p>Fit several models to this data:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Regression, no slope</span>
<span class="va">regression_model</span> <span class="op">=</span> <span class="fu"><a href="reference/fit_stan.html">fit_stan</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">s</span>, x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/model.matrix.html">model.matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">s</span><span class="op">~</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span>, model_name<span class="op">=</span><span class="st">"regression"</span><span class="op">)</span>

<span class="co"># Regression, with slope</span>
<span class="va">regression_model</span> <span class="op">=</span> <span class="fu"><a href="reference/fit_stan.html">fit_stan</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">s</span>, x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/model.matrix.html">model.matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">s</span><span class="op">~</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">s</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>, model_name<span class="op">=</span><span class="st">"regression"</span><span class="op">)</span>

<span class="co"># AR(1) time series model</span>
<span class="va">ar1_model</span> <span class="op">=</span> <span class="fu"><a href="reference/fit_stan.html">fit_stan</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">s</span>, est_drift<span class="op">=</span><span class="cn">FALSE</span>, P <span class="op">=</span> <span class="fl">1</span>, model_name <span class="op">=</span> <span class="st">"ar"</span><span class="op">)</span>

<span class="co"># ARMA(1,1) time series model</span>
<span class="va">arma1_model</span> <span class="op">=</span> <span class="fu"><a href="reference/fit_stan.html">fit_stan</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">s</span>, model_name <span class="op">=</span> <span class="st">"arma11"</span><span class="op">)</span>

<span class="co"># univariate ss model -- without drift but mean reversion estimated</span>
<span class="va">ss_model</span> <span class="op">=</span> <span class="fu"><a href="reference/fit_stan.html">fit_stan</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">s</span>, model_name <span class="op">=</span> <span class="st">"ss_ar"</span>, est_drift<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></code></pre></div>
<p>To see the Stan mode code behind each of these, look in the <code>inst/stan</code> folder on the GitHub repository. Note that <code>fit_stan.R</code> does some data preparation to deal with Stan not accepting NAs in the data.</p>
</div>
<div id="documentation" class="section level3">
<h3 class="hasAnchor">
<a href="#documentation" class="anchor"></a>DOCUMENTATION</h3>
<ul>
<li>
<a href="https://nwfsc-timeseries.github.io/atsa-labs/">ATSA lab book</a> - Many applications are covered in our Applied Time Series Analysis book developed from the labs in our course.</li>
<li>
<a href="https://nwfsc-timeseries.github.io/atsa/">ATSA course website</a> - We have lectures and all material from our course on our course website.</li>
<li>Additional information can be found on the NWFSC time series page which includes several additional books and packages, <a href="https://nwfsc-timeseries.github.io/">NWFSC time series page</a>
</li>
</ul>
</div>
<div id="citation" class="section level3">
<h3 class="hasAnchor">
<a href="#citation" class="anchor"></a>CITATION</h3>
<p>Ward, E.J., M.D. Scheuerell, and E.E. Holmes. 2018. ‘atsar’: Applied Time Series Analysis in R: an introduction to time series analysis for ecological and fisheries data with Stan. <a href="https://doi.org/10.5281/zenodo.1158021"><img src="https://zenodo.org/badge/DOI/10.5281/zenodo.1158021.svg" alt="DOI"></a></p>
</div>
<div id="noaa-disclaimer" class="section level3">
<h3 class="hasAnchor">
<a href="#noaa-disclaimer" class="anchor"></a>NOAA Disclaimer</h3>
<p>This repository is a scientific product and is not official communication of the National Oceanic and Atmospheric Administration, or the United States Department of Commerce. All NOAA GitHub project code is provided on an ‘as is’ basis and the user assumes responsibility for its use. Any claims against the Department of Commerce or Department of Commerce bureaus stemming from the use of this GitHub project will be governed by all applicable Federal law. Any reference to specific commercial products, processes, or services by service mark, trademark, manufacturer, or otherwise, does not constitute or imply their endorsement, recommendation or favoring by the Department of Commerce. The Department of Commerce seal and logo, or the seal and logo of a DOC bureau, shall not be used in any manner to imply endorsement of any commercial product or activity by DOC or the United States Government.</p>
</div>

  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <div class="links">
<h2>Links</h2>
<ul class="list-unstyled">
<li>Browse source code at <br><a href="https://github.com/nwfsc-timeseries/atsar/">https://​github.com/​nwfsc-timeseries/​atsar/​</a>
</li>
<li>Report a bug at <br><a href="https://github.com/nwfsc-timeseries/atsar/issues">https://​github.com/​nwfsc-timeseries/​atsar/​issues</a>
</li>
</ul>
</div>
<div class="license">
<h2>License</h2>
<ul class="list-unstyled">
<li>GPL (&gt;=3)</li>
</ul>
</div>
<div class="developers">
<h2>Developers</h2>
<ul class="list-unstyled">
<li>Eric J. Ward <br><small class="roles"> Author, maintainer </small>  </li>
<li>Mark D. Scheuerell <br><small class="roles"> Author </small>  </li>
<li>Elizabeth E. Holmes <br><small class="roles"> Author </small>  </li>
<li>Kiva L. Oken <br><small class="roles"> Author </small>  </li>
<li><a href="authors.html">All authors...</a></li>
</ul>
</div>

  <div class="dev-status">
<h2>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://github.com/nwfsc-timeseries/atsar/actions"><img src="https://github.com/nwfsc-timeseries/atsar/workflows/R-CMD-check/badge.svg" alt="R-CMD-check"></a></li>
</ul>
</div>
</div>
</div>


      <footer><div class="copyright">
  <p>Developed by Eric J. Ward, Mark D. Scheuerell, Elizabeth E. Holmes, Kiva L. Oken.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
